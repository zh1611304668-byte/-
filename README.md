# 纪念钞预约系统 - 独立自动填写程序

> 🎯 独立Python程序，连接到已打开的浏览器，直接操作当前页面

## ✨ 特点

- ✅ **独立程序** - 不是浏览器扩展或控制台脚本
- ⚡ **不重新加载页面** - 连接到你已打开的浏览器页面
- 🚀 **超高速** - 并发填写，< 1秒完成
- 🔒 **不被检测** - 通过官方CDP协议连接
- 🎨 **图形界面** - 简洁美观的GUI，一键操作

## 🎨 推荐：图形界面版本

**双击运行 `run_gui.bat`** - 打开图形界面，功能包括：
- ✅ 可视化配置编辑
- ✅ **一键启动浏览器（已集成，无需单独启动）**
- ✅ 一键连接浏览器
- ✅ 一键自动填写
- ✅ 实时日志显示
- ✅ 支持多用户、多窗口同时操作

![GUI界面预览](使用图形界面更方便！)

## 🚀 快速开始（图形界面版本）

### 第1步：安装依赖

双击运行 `install.bat`，会自动安装所有依赖

或手动安装：
```bash
pip install playwright
playwright install chromium
```

### 第2步：启动GUI程序

**双击运行 `run_gui.bat`**

### 第3步：在GUI中操作

1. **点击"🚀 启动浏览器"按钮** - 程序会自动启动调试模式的Chrome/Edge浏览器
2. **在弹出的浏览器中手动打开预约页面**
3. **配置用户信息和网点信息**（可添加多个用户）
4. **点击"🔗 连接选中"** - 连接到浏览器
5. **点击"⚡ 填写选中"** - 自动填写表单
6. **手动输入验证码并提交**

### 多窗口模式（批量预约）

1. 设置窗口数量（如：3）
2. 点击"🚀✖️ 启动多个浏览器"
3. 在每个浏览器窗口中打开预约页面
4. 点击"🔗 全部连接"
5. 点击"⚡ 全部填写"

---

## 🚀 快速开始（命令行版本）

### 第1步：安装依赖

双击运行 `install.bat`，会自动安装所有依赖

或手动安装：
```bash
pip install playwright
playwright install chromium
```

### 第2步：配置信息

编辑 `config.json`，填写你的个人信息：
```json
{
  "user_info": {
    "name": "你的姓名",
    "id_type": "身份证",
    "id_number": "你的证件号",
    "phone": "你的手机号"
  },
  "exchange_location": {
    "name": "辽宁省",
    "keyword": "网点关键词"
  },
  "quantity": 20
}
```

### 第3步：启动浏览器

**双击运行 `start_browser.bat`**

这会启动一个带调试端口的Chrome浏览器。
然后在浏览器中**手动打开预约页面**。

### 第4步：运行自动填写

**双击运行 `run.bat`**

程序会：
1. 自动连接到你已打开的浏览器
2. 找到当前活动的标签页
3. 超高速填写所有表单字段
4. 等待你手动输入验证码并提交

## 📝 使用流程

```
1. start_browser.bat  → 启动Chrome (调试模式)
2. 在浏览器中打开预约页面
3. run.bat           → 运行自动填写程序
4. 手动输入验证码
5. 点击提交按钮
```

## ⚡ 性能

- **表单填写速度**: < 1秒
- **总耗时**: 约 0.5-1秒（取决于网络）

## 🔧 技术原理

使用 Playwright 的 CDP (Chrome DevTools Protocol) 连接到已运行的浏览器：
- 浏览器以 `--remote-debugging-port=9222` 启动
- Python程序通过CDP连接到端口9222
- 直接操作当前页面，不重新加载

## 💡 常见问题

### Q: 提示连接失败？
A: 确保先运行 `start_browser.bat` 启动浏览器

### Q: 找不到页面？
A: 确保在启动的Chrome浏览器中打开了预约页面

### Q: 字段没有填写？
A: 运行程序后，如果有未填写的字段，告诉我控制台输出

### Q: 能用Edge浏览器吗？
A: 可以，修改 `start_browser.bat` 中的 `chrome.exe` 为 `msedge.exe`

## 🛡️ 安全说明

- 程序只连接到本地浏览器（localhost:9222）
- 不会发送数据到外部服务器
- 配置文件包含个人信息，请妥善保管

---

**祝预约成功！** 🎉
